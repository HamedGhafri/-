<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المفضلة | ديوان حمد الغافري</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button class="theme-toggle" id="themeToggle"><i class="fas fa-moon"></i></button>

    <nav class="navbar">
        <div class="container">
            <div class="nav-brand"><i class="fas fa-book-open"></i><span>ديوان حمد الغافري</span></div>
            <ul class="nav-menu" id="navMenu">
                <li><a href="index.html"><i class="fas fa-home"></i> الرئيسية</a></li>
                <li><a href="categories.html"><i class="fas fa-layer-group"></i> التصنيفات</a></li>
                <li><a href="search.html"><i class="fas fa-search"></i> البحث</a></li>
                <li><a href="favorites.html" class="active"><i class="fas fa-heart"></i> المفضلة</a></li>
                <li><a href="about.html"><i class="fas fa-user"></i> عن الشاعر</a></li>
            </ul>
            <button class="nav-toggle" id="navToggle"><i class="fas fa-bars"></i></button>
        </div>
    </nav>

    <main class="container main-content">
        <section class="favorites-section">
            <div class="section-header">
                <h1><i class="fas fa-heart"></i> المفضلة</h1>
                <button class="clear-all-btn" id="clearAllBtn" style="display: none;">
                    <i class="fas fa-trash"></i> حذف الكل
                </button>
            </div>

            <div id="favoritesContainer"></div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2024 ديوان حمد الغافري. جميع الحقوق محفوظة.</p>
            </div>
        </div>
    </footer>

    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage"></span>
    </div>

    <style>
        .favorites-section { min-height: 70vh; padding: var(--spacing-xl) 0; }
        .clear-all-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: var(--spacing-xs) var(--spacing-md);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-family: var(--font-secondary);
            transition: all var(--transition-fast);
        }
        .clear-all-btn:hover { background: #c0392b; }
        .favorite-item {
            background: var(--surface-color);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
            box-shadow: var(--shadow-sm);
            border-right: 4px solid var(--primary-color);
            transition: all var(--transition-normal);
        }
        .favorite-item:hover { transform: translateY(-3px); box-shadow: var(--shadow-md); }
        .favorite-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--spacing-sm);
        }
        .favorite-title { font-size: 1.3rem; color: var(--primary-color); font-weight: 600; }
        .remove-favorite-btn {
            background: transparent;
            border: none;
            color: #e74c3c;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform var(--transition-fast);
        }
        .remove-favorite-btn:hover { transform: scale(1.2); }
        .favorite-content {
            color: var(--text-secondary);
            line-height: 1.8;
            font-size: 1.1rem;
            margin-bottom: var(--spacing-sm);
        }
        .favorite-date {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-family: var(--font-secondary);
        }
        .empty-favorites {
            text-align: center;
            padding: var(--spacing-xl);
        }
        .empty-favorites i {
            font-size: 5rem;
            color: var(--text-muted);
            opacity: 0.3;
            margin-bottom: var(--spacing-md);
        }
        .empty-favorites h3 { color: var(--text-primary); margin-bottom: var(--spacing-sm); }
        .empty-favorites p { color: var(--text-muted); }
    </style>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', loadFavorites);

        function loadFavorites() {
            const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            const container = document.getElementById('favoritesContainer');
            const clearBtn = document.getElementById('clearAllBtn');

            if (favorites.length === 0) {
                container.innerHTML = `
                    <div class="empty-favorites">
                        <i class="fas fa-heart-broken"></i>
                        <h3>لا توجد مفضلة حالياً</h3>
                        <p>ابدأ بإضافة قصائدك وأبياتك المفضلة</p>
                        <a href="index.html" class="cta-btn primary" style="display: inline-flex; margin-top: var(--spacing-md);">
                            <i class="fas fa-home"></i> العودة للرئيسية
                        </a>
                    </div>
                `;
                clearBtn.style.display = 'none';
                return;
            }

            clearBtn.style.display = 'block';
            clearBtn.onclick = clearAllFavorites;

            container.innerHTML = favorites.reverse().map((fav, index) => `
                <div class="favorite-item">
                    <div class="favorite-header">
                        <h3 class="favorite-title">${fav.poemTitle || 'بيت شعري'}</h3>
                        <button class="remove-favorite-btn" onclick="removeFavorite(${favorites.length - 1 - index})">
                            <i class="fas fa-times-circle"></i>
                        </button>
                    </div>
                    <p class="favorite-content">${fav.verse || fav.content || ''}</p>
                    <p class="favorite-date"><i class="fas fa-clock"></i> ${formatDate(fav.timestamp)}</p>
                </div>
            `).join('');
        }

        function removeFavorite(index) {
            let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            favorites.splice(favorites.length - 1 - index, 1);
            localStorage.setItem('favorites', JSON.stringify(favorites));
            showToast('تم حذف العنصر من المفضلة');
            loadFavorites();
        }

        function clearAllFavorites() {
            if (confirm('هل أنت متأكد من حذف جميع المفضلة؟')) {
                localStorage.setItem('favorites', JSON.stringify([]));
                showToast('تم حذف جميع المفضلة');
                loadFavorites();
            }
        }

        function formatDate(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleDateString('ar-SA', { year: 'numeric', month: 'long', day: 'numeric' });
        }
    </script>
</body>
</html>
