<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>موقع قصائد حمد الغافري</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <h1 class="title">موقع قصائد حمد الغافري</h1>

    <p class="bio">
        حمد الغافري، شاعر ينسج من اللغة ثيابها الأولى، ويستخرج من بحور الشعر لآلئه الخالدة. 
        يحمل في قصائده ملامح الأرض، وعبق الجبال، وصدق الإنسان العماني في بيانه. 
        يكتب ليترك أثرًا، ولتكون كلمته نافذة إلى القلب قبل أن تكون بيتًا موزونًا.
    </p>

    <h2 class="subtitle">فهرس القصائد</h2>

    <div id="poems" class="list">جاري التحميل...</div>

    <script>
        async function loadPoems() {
            try {
                const res = await fetch('poems/');
                const text = await res.text();

                const files = [...text.matchAll(/href="([^"]+\.txt)"/g)]
                    .map(m => m[1])
                    .filter(name => !name.includes("placeholder"));

                const container = document.getElementById("poems");
                container.innerHTML = "";

                files.forEach((file, index) => {
                    const title = decodeURIComponent(file.replace('.txt', '').replace(/-/g, ' '));

                    const a = document.createElement("a");
                    a.href = `viewer.html?file=${file}`;
                    a.className = "poem-link";
                    a.textContent = title;
                    container.appendChild(a);
                });

            } catch (e) {
                document.getElementById("poems").textContent = "⚠️ لا يمكن تحميل القصائد";
            }
        }

        loadPoems();
    </script>

</body>
</html>
