<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø¯ÙŠÙˆØ§Ù† Ø­Ù…Ø¯ Ø§Ù„ØºØ§ÙØ±ÙŠ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="fade">

<button id="modeToggle" onclick="toggleMode()">ğŸŒ“</button>

<div class="container">

    <h1>Ø¯ÙŠÙˆØ§Ù† Ø­Ù…Ø¯ Ø§Ù„ØºØ§ÙØ±ÙŠ</h1>

    <div class="actions">
        <a class="btn" href="#" onclick="randomPoem()">Ù‚ØµÙŠØ¯Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©</a>
        <a class="btn" href="about.html">Ø¹Ù† Ø§Ù„Ø´Ø§Ø¹Ø±</a>
    </div>

    <input type="text" id="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù‚ØµÙŠØ¯Ø©..." oninput="filterPoems()">

    <div id="todayBox" class="today-box fade">
        <div class="today-title">Ø¨ÙŠØª Ø§Ù„ÙŠÙˆÙ…</div>
        <div id="todayContent"></div>
    </div>

    <div id="list" class="fade">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>

</div>

<script>
let poemList = [];
let allLines = [];

/* === Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ === */
function toggleMode() {
    document.body.classList.toggle("dark");
    localStorage.setItem("darkMode", document.body.classList.contains("dark"));
}

if (localStorage.getItem("darkMode") === "true") {
    document.body.classList.add("dark");
}

/* === ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ØµØ§Ø¦Ø¯ === */
async function loadPoems() {
    const res = await fetch("poems.txt");
    const text = await res.text();

    const poems = text.split("===\n").map(p => p.trim()).filter(p => p);

    poemList = poems.map((poem, index) => ({
        id: index,
        title: poem.split("\n")[0].trim()
    }));

    display(poemList);

    poems.forEach(poem => {
        const lines = poem.split("\n").slice(1).filter(l => l.trim());
        allLines.push(...lines);
    });

    showBaytOfDay();
}

/* === Ø¹Ø±Ø¶ Ø§Ù„ÙÙ‡Ø±Ø³ === */
function display(arr) {
    const list = document.getElementById("list");
    list.innerHTML = "";

    arr.forEach(poem => {
        list.innerHTML += `
            <a class="poem-card fade" href="viewer.html?id=${poem.id}">
                ${poem.title}
            </a>
        `;
    });
}

/* === Ø§Ù„Ø¨Ø­Ø« === */
function filterPoems() {
    const text = document.getElementById("search").value.trim();
    display(poemList.filter(p => p.title.includes(text)));
}

/* === Ù‚ØµÙŠØ¯Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© === */
function randomPoem() {
    const id = Math.floor(Math.random() * poemList.length);
    window.location.href = `viewer.html?id=${id}`;
}

/* === Ø¨ÙŠØª Ø§Ù„ÙŠÙˆÙ… === */
function showBaytOfDay() {
    const today = new Date().getDate();
    const index = today % allLines.length;
    const line1 = allLines[index];
    const line2 = allLines[index + 1] || "";
    document.getElementById("todayContent").innerHTML = `${line1}<br>${line2}`;
}

loadPoems();
</script>

</body>
</html>function toggleMode() {
    document.body.classList.toggle("dark");
    localStorage.setItem("darkMode", document.body.classList.contains("dark"));
}

if (localStorage.getItem("darkMode") === "true") {
    document.body.classList.add("dark");
}

/* === ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ØµØ§Ø¦Ø¯ === */
async function loadPoems() {
    const res = await fetch("poems.txt");
    const text = await res.text();

    const poems = text.split("===\n").map(p => p.trim()).filter(p => p);

    poemList = poems.map((poem, index) => ({
        id: index,
        title: poem.split("\n")[0].trim()
    }));

    display(poemList);

    poems.forEach(poem => {
        const lines = poem.split("\n").slice(1).filter(l => l.trim());
        allLines.push(...lines);
    });

    showBaytOfDay();
}

/* === Ø¹Ø±Ø¶ Ø§Ù„ÙÙ‡Ø±Ø³ === */
function display(arr) {
    const list = document.getElementById("list");
    list.innerHTML = "";

    arr.forEach(poem => {
        list.innerHTML += `
            <a class="poem-card fade" href="viewer.html?id=${poem.id}">
                ${poem.title}
            </a>
        `;
    });
}

/* === Ø§Ù„Ø¨Ø­Ø« === */
function filterPoems() {
    const text = document.getElementById("search").value.trim();
    display(poemList.filter(p => p.title.includes(text)));
}

/* === Ù‚ØµÙŠØ¯Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© === */
function randomPoem() {
    const id = Math.floor(Math.random() * poemList.length);
    window.location.href = `viewer.html?id=${id}`;
}

/* === Ø¨ÙŠØª Ø§Ù„ÙŠÙˆÙ… === */
function showBaytOfDay() {
    const today = new Date().getDate();
    const index = today % allLines.length;
    const line1 = allLines[index];
    const line2 = allLines[index + 1] || "";
    document.getElementById("todayContent").innerHTML = `${line1}<br>${line2}`;
}

loadPoems();
</script>

</body>
</html>
async function loadPoems() {
    const res = await fetch("poems.txt");
    const text = await res.text();

    const poems = text.split("===\n")
        .map(p => p.trim())
        .filter(p => p);

    poemList = poems.map((poem, index) => {
        return {
            id: index,
            title: poem.split("\n")[0].trim()
        };
    });

    display(poemList);

    // Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙƒÙ„ Ø§Ù„Ø£Ø¨ÙŠØ§Øª
    poems.forEach(poem => {
        const lines = poem.split("\n").slice(1).filter(l => l.trim());
        allLines.push(...lines);
    });

    showBaytOfDay();
}

function display(arr) {
    const list = document.getElementById("list");
    list.innerHTML = "";

    arr.forEach(poem => {
        list.innerHTML += `
            <a class="poem-card" href="viewer.html?id=${poem.id}">
                ${poem.title}
            </a>
        `;
    });
}

function filterPoems() {
    const text = document.getElementById("search").value.trim();
    const filtered = poemList.filter(p => p.title.includes(text));
    display(filtered);
}

function randomPoem() {
    const id = Math.floor(Math.random() * poemList.length);
    window.location.href = `viewer.html?id=${id}`;
}

/* Ø¨ÙŠØª Ø§Ù„ÙŠÙˆÙ… */
function showBaytOfDay() {
    const today = new Date().getDate();
    const index = today % allLines.length;

    const bayt1 = allLines[index];
    const bayt2 = allLines[index + 1] || "";

    document.getElementById("todayContent").innerHTML = `
        ${bayt1}<br>${bayt2}
    `;
}

loadPoems();
</script>

</body>
</html>
